{% extends 'base.html' %}
{% load static %}

{% block title %}Eric's Consulting - Professional Legal & Business Services{% endblock %}

{% block css %}
<style>
    /* Hero Section Specific Styles */
    .modern-hero {
        background: linear-gradient(135deg, #2563eb 0%, #3b82f6 50%, #0ea5e9 100%);
        padding: 120px 0 100px;
        position: relative;
        overflow: hidden;
    }

    .modern-hero::before {
        content: '';
        position: absolute;
        width: 150%;
        height: 150%;
        background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 1px, transparent 1px);
        background-size: 50px 50px;
        animation: moveGrid 20s linear infinite;
    }

    @keyframes moveGrid {
        0% { transform: translate(0, 0); }
        100% { transform: translate(50px, 50px); }
    }

    .hero-content {
        position: relative;
        z-index: 2;
    }

    @keyframes shimmer {
        0%, 100% { transform: translate(0, 0); opacity: 0; }
        50% { transform: translate(-25%, -25%); opacity: 1; }
    }

    @media (max-width: 991px) {
        .modern-hero {
            min-height: auto !important;
            padding: 80px 0 60px;
        }
        .hero-image img {
            height: 400px !important;
        }
        .hero-image > div {
            transform: perspective(1000px) rotateY(-3deg) rotateX(1deg) !important;
        }
    }

    @media (max-width: 767px) {
        .modern-hero {
            min-height: auto !important;
        }
        .hero-image img {
            height: 350px !important;
        }
        .hero-image > div {
            transform: none !important;
            border-radius: 20px !important;
        }
    }

    /* Feature Cards */
    .feature-card {
        background: white;
        border-radius: 20px;
        padding: 30px;
        text-align: center;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);
        transition: all 0.3s ease;
        height: 100%;
        border: 2px solid transparent;
    }

    .feature-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 20px 40px rgba(37, 99, 235, 0.2);
        border-color: #2563eb;
    }

    .feature-icon {
        width: 80px;
        height: 80px;
        margin: 0 auto 20px;
    }

    /* Stats Section */
    .stats-card {
        text-align: center;
        padding: 30px;
    }

    .stat-value {
        font-size: 3.5rem;
        font-weight: 800;
        color: white;
        line-height: 1;
        margin-bottom: 10px;
    }

    .stat-label {
        font-size: 1.125rem;
        color: rgba(255, 255, 255, 0.9);
        font-weight: 500;
    }

    /* About Section */
    .about-card {
        background: linear-gradient(135deg, #f8fafc 0%, #e0e7ff 100%);
        border-radius: 24px;
        padding: 50px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
    }

    /* Team Section */
    .team-carousel .owl-nav {
        display: none;
    }

    .team-carousel .owl-dots {
        margin-top: 30px;
        text-align: center;
    }

    .team-carousel .owl-dot {
        width: 12px;
        height: 12px;
        background: #cbd5e1;
        border-radius: 50%;
        display: inline-block;
        margin: 0 5px;
        transition: all 0.3s ease;
    }

    .team-carousel .owl-dot.active {
        background: #2563eb;
        width: 30px;
        border-radius: 6px;
    }

    /* Comment/Testimonial Section */
    .comment-form {
        background: white;
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        margin-top: 40px;
    }

    /* ========================================
       MODERN CHAT WIDGET - COMPLETELY REDESIGNED
       ======================================== */

    /* Chat Toggle Button (Bottom Left) */
    .chat-toggle-btn {
        position: fixed;
        bottom: 25px;
        left: 25px;
        width: 60px;
        height: 60px;
        background: #ffffff;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        z-index: 1000;
        transition: all 0.3s ease;
    }

    .chat-toggle-btn:hover {
        transform: scale(1.05);
        box-shadow: 0 6px 30px rgba(0, 0, 0, 0.2);
    }

    .chat-toggle-btn i {
        font-size: 28px;
        color: #1e40af;
    }

    /* Pulsing animation for chat icon */
    .chat-toggle-btn::before {
        content: '';
        position: absolute;
        width: 100%;
        height: 100%;
        border-radius: 50%;
        background: #1e40af;
        opacity: 0;
        animation: pulse 2s infinite;
    }

    @keyframes pulse {
        0% {
            transform: scale(1);
            opacity: 0.6;
        }
        50% {
            transform: scale(1.3);
            opacity: 0;
        }
        100% {
            transform: scale(1.3);
            opacity: 0;
        }
    }

    /* Main Chat Container */
    .modern-chat-container {
        position: fixed;
        bottom: 100px;
        left: 25px;
        width: 400px;
        max-width: calc(100vw - 50px);
        height: 580px;
        max-height: calc(100vh - 130px);
        background: linear-gradient(180deg, #1e3a8a 0%, #1e40af 100%);
        border-radius: 20px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        display: none;
        flex-direction: column;
        overflow: hidden;
        z-index: 999;
        animation: slideIn 0.3s ease;
    }

    .modern-chat-container.active {
        display: flex;
    }

    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Chat Header */
    .modern-chat-header {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        padding: 20px;
        display: flex;
        align-items: center;
        gap: 12px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .chat-avatar {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        overflow: hidden;
        border: 2px solid rgba(255, 255, 255, 0.3);
        flex-shrink: 0;
    }

    .chat-avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .chat-header-info {
        flex: 1;
    }

    .chat-header-info h6 {
        margin: 0;
        color: white;
        font-size: 16px;
        font-weight: 600;
    }

    .chat-header-info p {
        margin: 0;
        color: rgba(255, 255, 255, 0.7);
        font-size: 12px;
    }

    .chat-close-btn {
        background: none;
        border: none;
        color: white;
        font-size: 24px;
        cursor: pointer;
        padding: 0;
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0.7;
        transition: all 0.2s ease;
    }

    .chat-close-btn:hover {
        opacity: 1;
        transform: rotate(90deg);
    }

    /* Chat Messages Area */
    .modern-chat-messages {
        flex: 1;
        padding: 20px 16px;
        overflow-y: auto;
        background: #f5f7fa;
        display: flex;
        flex-direction: column;
        gap: 16px;
    }

    /* Individual Message */
    .chat-message {
        width: 100%;
        display: flex;
        align-items: flex-start;
        justify-content: flex-start;
        gap: 10px;
        animation: messageSlide 0.3s ease;
    }

    @keyframes messageSlide {
        from {
            opacity: 0;
            transform: translateY(10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .chat-message.user-message {
        justify-content: flex-start !important;    /* ðŸ”¥ qoâ€˜shildi */
        flex-direction: row-reverse !important;  /* ðŸ”¥ qoâ€˜shildi */
        text-align: right !important;
    }

    .chat-message.bot-message {
        justify-content: flex-start !important;  /* ðŸ”¥ qoâ€˜shildi */
        flex-direction: row !important;          /* ðŸ”¥ qoâ€˜shildi */
        text-align: left !important;
        align-items: flex-start !important;
    }

    .message-avatar {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        overflow: hidden;
        flex-shrink: 0;
        background: #e0e7ff;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .message-avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .message-avatar i {
        font-size: 14px;
        color: #1e40af;
    }

    .message-bubble {
    display: flex;              /* ðŸ”¥ qoâ€˜shildi */
    flex-direction: column;     /* ðŸ”¥ qoâ€˜shildi */
    max-width: 70%;             /* xavfsiz */
    }

    .message-content {
        max-width: 100%;
        padding: 12px 16px;
        border-radius: 28px;
        font-size: 14px;
        line-height: 1.5;
        word-wrap: break-word;
    }

    .chat-message.bot-message .message-content {
        background: white;
        color: #374151;
        border-top-left-radius: 18px;
        border-top-right-radius: 18px;
        border-bottom-left-radius: 0;
        border-bottom-right-radius: 18px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }

    .chat-message.user-message .message-content {
        background: linear-gradient(135deg, #3b82f6, #2563eb);
        color: white;
        border-top-left-radius: 18px;
        border-top-right-radius: 18px;
        border-bottom-left-radius: 18px;
        border-bottom-right-radius: 0; /* oâ€˜ng tomoni kesilgan radius */
        box-shadow: 0 2px 8px rgba(37, 99, 235, 0.3);
    }

    .message-time {
        font-size: 11px;
        color: #9ca3af;
        margin-top: 4px;
        padding: 0 4px;
    }

    /* Chat Input Area */
    .modern-chat-input {
        background: white;
        padding: 15px 20px;
        border-top: 1px solid #e5e7eb;
        display: flex;
        gap: 10px;
        align-items: center;
    }

    .chat-input-field {
        flex: 1;
        padding: 12px 16px;
        border: 1px solid #e5e7eb;
        border-radius: 24px;
        font-size: 14px;
        outline: none;
        transition: all 0.3s ease;
        background: #f9fafb;
    }

    .chat-input-field:focus {
        border-color: #3b82f6;
        background: white;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }

    .chat-send-btn {
        width: 42px;
        height: 42px;
        background: linear-gradient(135deg, #3b82f6, #2563eb);
        border: none;
        border-radius: 50%;
        color: white;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
        transition: all 0.3s ease;
        box-shadow: 0 2px 8px rgba(37, 99, 235, 0.3);
    }

    .chat-send-btn:hover:not(:disabled) {
        transform: scale(1.05);
        box-shadow: 0 4px 12px rgba(37, 99, 235, 0.4);
    }

    .chat-send-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    .chat-send-btn i {
        font-size: 16px;
    }

    /* Scrollbar Styling */
    .modern-chat-messages::-webkit-scrollbar {
        width: 6px;
    }

    .modern-chat-messages::-webkit-scrollbar-track {
        background: transparent;
    }

    .modern-chat-messages::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 10px;
    }

    .modern-chat-messages::-webkit-scrollbar-thumb:hover {
        background: #94a3b8;
    }

    /* ========================================
       MOBILE RESPONSIVE
       ======================================== */

    /* Small tablets (768px and below) */
    @media (max-width: 768px) {
        .chat-toggle-btn {
            bottom: 20px;
            left: 20px;
            width: 55px;
            height: 55px;
        }

        .chat-toggle-btn i {
            font-size: 26px;
        }

        .modern-chat-container {
            bottom: 90px;
            left: 15px;
            right: 15px;
            width: auto;
            max-width: 100%;
            height: 75vh;
            max-height: 600px;
        }
    }

    /* Mobile phones (576px and below) */
    @media (max-width: 576px) {
        .chat-toggle-btn {
            bottom: 15px;
            left: 15px;
            width: 52px;
            height: 52px;
        }

        .chat-toggle-btn i {
            font-size: 24px;
        }

        .modern-chat-container {
            bottom: 80px;
            left: 10px;
            right: 10px;
            width: auto;
            height: 70vh;
            max-height: 550px;
            border-radius: 20px;
        }

        .modern-chat-header {
            padding: 16px;
        }

        .chat-avatar {
            width: 40px;
            height: 40px;
        }

        .chat-header-info h6 {
            font-size: 15px;
        }

        .chat-header-info p {
            font-size: 12px;
        }

        .modern-chat-messages {
            padding: 16px 12px;
            gap: 14px;
        }

        .message-avatar {
            width: 30px;
            height: 30px;
        }

        .message-avatar i {
            font-size: 15px;
        }

        .message-content {
            max-width: 100%;
            padding: 11px 15px;
            font-size: 14px;
            line-height: 1.45;
        }

        .message-time {
            font-size: 11px;
        }

        .modern-chat-input {
            padding: 14px 16px;
        }

        .chat-input-field {
            padding: 11px 16px;
            font-size: 14px;
        }

        .chat-send-btn {
            width: 42px;
            height: 42px;
        }

        .chat-send-btn i {
            font-size: 16px;
        }
    }

    /* Very small phones (380px and below) */
    @media (max-width: 380px) {
        .chat-toggle-btn {
            width: 48px;
            height: 48px;
            bottom: 30px;
            left: 12px;
        }

        .chat-toggle-btn i {
            font-size: 22px;
        }

        .modern-chat-container {
            bottom: 70px;
            left: 8px;
            right: 8px;
            height: 65vh;
            max-height: 500px;
            border-radius: 18px;
        }

        .modern-chat-header {
            padding: 14px;
        }

        .chat-avatar {
            width: 36px;
            height: 36px;
        }

        .modern-chat-messages {
            padding: 14px 10px;
        }

        .message-avatar {
            width: 28px;
            height: 28px;
        }

        .message-avatar i {
            font-size: 14px;
        }

        .message-content {
            padding: 10px 14px;
            font-size: 13px;
            max-width: 100%;
        }

        .message-time {
            font-size: 10px;
        }

        .chat-input-field {
            padding: 10px 14px;
            font-size: 13px;
        }

        .chat-send-btn {
            width: 38px;
            height: 38px;
        }

        .chat-send-btn i {
            font-size: 15px;
        }
    }
</style>
{% endblock %}

{% block content %}

<!-- Modern Hero Section -->
<section class="modern-hero" style="min-height: 800px; display: flex; align-items: center;">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-5 mb-5 mb-lg-0">
                <div class="hero-content wow fadeInLeft" data-wow-delay="0.1s">
                    <h1 class="hero-title text-white mb-4">
                        The Best Legal Jurisdiction Begins Here
                    </h1>
                    <p class="hero-subtitle text-white mb-4">
                        Expert legal consultation and services tailored to individuals and businesses navigating the complexities of U.S. law. Professional guidance you can trust.
                    </p>
                    <div class="hero-buttons">
                        <a href="{% url 'service' %}" class="btn btn-secondary btn-lg">
                            <i class="fas fa-briefcase me-2"></i>Our Services
                        </a>
                        <a href="{% url 'contact' %}" class="btn btn-outline btn-lg" style="border-color: white; color: white;">
                            <i class="fas fa-phone me-2"></i>Contact Us
                        </a>
                    </div>
                </div>
            </div>
            <div class="col-lg-7">
                <div class="hero-image wow fadeInRight" data-wow-delay="0.3s" style="position: relative;">
                    <div style="position: relative; overflow: hidden; border-radius: 30px; box-shadow: 0 40px 80px rgba(0, 0, 0, 0.5); transform: perspective(1200px) rotateY(-8deg) rotateX(2deg);">
                        <img src="{% static 'img/carousel-1.jpg' %}" alt="Legal Consulting" class="img-fluid" style="width: 100%; height: 600px; object-fit: cover; display: block; border-radius: 30px;">
                        <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(37, 99, 235, 0.15) 0%, rgba(59, 130, 246, 0.1) 100%); border-radius: 30px;"></div>
                        <div style="position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%); animation: shimmer 3s infinite;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Stats Section -->
<section class="stats-section py-5">
    <div class="container py-4">
        <div class="row g-4">
            <div class="col-lg-3 col-md-6 wow fadeIn" data-wow-delay="0.1s">
                <div class="stats-card">
                    <div class="stat-value" data-toggle="counter-up">120</div>
                    <div class="stat-label">Happy Clients</div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 wow fadeIn" data-wow-delay="0.2s">
                <div class="stats-card">
                    <div class="stat-value" data-toggle="counter-up">144</div>
                    <div class="stat-label">Projects Succeed</div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 wow fadeIn" data-wow-delay="0.3s">
                <div class="stats-card">
                    <div class="stat-value" data-toggle="counter-up">159</div>
                    <div class="stat-label">Active Projects</div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 wow fadeIn" data-wow-delay="0.4s">
                <div class="stats-card">
                    <div class="stat-value" data-toggle="counter-up">15</div>
                    <div class="stat-label">Pending Projects</div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Features/Why Choose Us Section -->
<section class="section-padding bg-light">
    <div class="container">
        <div class="row mb-5">
            <div class="col-lg-8 mx-auto text-center wow fadeInUp" data-wow-delay="0.1s">
                <h2 class="section-title">Why Choose Us</h2>
                <p class="section-subtitle">
                    We stand out with our unwavering commitment to clients, personalized service, and comprehensive solutions tailored to your needs.
                </p>
            </div>
        </div>
        <div class="row g-4">
            <div class="col-lg-3 col-md-6 wow fadeInUp" data-wow-delay="0.1s">
                <div class="feature-card">
                    <img src="{% static 'img/icon/icon-06-primary.png' %}" alt="Easy Process" class="feature-icon">
                    <h5 class="mb-3">Easy Process</h5>
                    <p class="text-muted">Streamlined procedures designed for your convenience and peace of mind.</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 wow fadeInUp" data-wow-delay="0.2s">
                <div class="feature-card">
                    <img src="{% static 'img/icon/icon-03-primary.png' %}" alt="Fast Delivery" class="feature-icon">
                    <h5 class="mb-3">Fast Delivery</h5>
                    <p class="text-muted">Quick turnaround times without compromising on quality or accuracy.</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 wow fadeInUp" data-wow-delay="0.3s">
                <div class="feature-card">
                    <img src="{% static 'img/icon/icon-04-primary.png' %}" alt="Expert Guidance" class="feature-icon">
                    <h5 class="mb-3">Expert Guidance</h5>
                    <p class="text-muted">Professional advice from experienced legal consultants you can trust.</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 wow fadeInUp" data-wow-delay="0.4s">
                <div class="feature-card">
                    <img src="{% static 'img/icon/icon-07-primary.png' %}" alt="Cost Effective" class="feature-icon">
                    <h5 class="mb-3">Cost Effective</h5>
                    <p class="text-muted">Affordable solutions that deliver exceptional value for your investment.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- About Us Section -->
<section class="section-padding">
    <div class="container">
        <div class="row">
            <div class="col-lg-10 mx-auto wow fadeInUp" data-wow-delay="0.1s">
                <div class="about-card">
                    <h2 class="section-title text-center mb-4">About Eric's Consulting</h2>
                    <div class="row g-4">
                        <div class="col-md-6">
                            <p style="font-size: 1.0625rem; line-height: 1.8; color: #475569;">
                                <strong>Eric's Consulting LLC</strong> was established on March 3, 2023, in Loveland, Ohio, USA. Our mission is to provide comprehensive civil services to the Uzbek community and brotherly peoples from the Central Asian region living in America.
                            </p>
                            <p style="font-size: 1.0625rem; line-height: 1.8; color: #475569;">
                                We specialize in business entity formation, streamlining trucking company operations, and providing placement assistance, license acquisition, loan support, tax advice, housing services, visa consultations, childcare, and school placement services.
                            </p>
                        </div>
                        <div class="col-md-6">
                            <p style="font-size: 1.0625rem; line-height: 1.8; color: #475569;">
                                Our main goal is to offer affordable and high-quality services to Uzbek citizens living in the USA!
                            </p>
                            <p style="font-size: 1.0625rem; line-height: 1.8; color: #475569;">
                                Founded and led by <strong>lawyer Erkinbai Abdullaev</strong>, who brings 14 years of experience from various ministries and agencies of the republic, plus 2 years working in the branch of a German logistics company in Poland.
                            </p>
                            <div class="mt-4">
                                <a href="{% url 'service' %}" class="btn btn-primary">
                                    <i class="fas fa-arrow-right me-2"></i>Explore Our Services
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Team Section -->
<section class="section-padding bg-light">
    <div class="container">
        <div class="row mb-5">
            <div class="col-lg-8 mx-auto text-center wow fadeInUp" data-wow-delay="0.1s">
                <h2 class="section-title">Meet Our Expert Team</h2>
                <p class="section-subtitle">
                    Our team of highly experienced professionals is dedicated to providing the best service possible with professionalism and expertise.
                </p>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <div class="team-carousel owl-carousel wow fadeInUp" data-wow-delay="0.2s">
                    {% for member in team_members %}
                        <div class="team-card">
                            <div class="team-img-wrapper">
                                {% if member.user.profile_picture %}
                                    <img src="{{ member.user.profile_picture.url }}" alt="{{ member.user.first_name }} {{ member.user.last_name }}">
                                {% else %}
                                    <img src="{% static 'img/icon/logo-white.png' %}" alt="Default Profile">
                                {% endif %}
                                <div class="team-overlay">
                                    <div class="team-social">
                                        {% if member.twitter %}
                                            <a href="{{ member.twitter }}" target="_blank"><i class="fab fa-twitter"></i></a>
                                        {% endif %}
                                        {% if member.instagram %}
                                            <a href="{{ member.instagram }}" target="_blank"><i class="fab fa-instagram"></i></a>
                                        {% endif %}
                                        {% if member.facebook %}
                                            <a href="{{ member.facebook }}" target="_blank"><i class="fab fa-facebook-f"></i></a>
                                        {% endif %}
                                        {% if member.linkedin %}
                                            <a href="{{ member.linkedin }}" target="_blank"><i class="fab fa-linkedin-in"></i></a>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            <div class="team-info">
                                <h5 class="team-name">{{ member.user.first_name }} {{ member.user.last_name }}</h5>
                                <p class="team-role mb-0">{{ member.role }}</p>
                            </div>
                            <div class="team-description">
                                {% if member.description %}
                                    <p>{{ member.description }}</p>
                                {% else %}
                                    <p>Bringing a fresh perspective and innovative approach, {{ member.user.first_name }} is instrumental in developing creative strategies and solutions.</p>
                                {% endif %}
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Testimonials Section -->
<section class="section-padding">
    <div class="container">
        <div class="row mb-5">
            <div class="col-lg-8 mx-auto text-center wow fadeInUp" data-wow-delay="0.1s">
                <h2 class="section-title">What People Are Saying</h2>
                <p class="section-subtitle">
                    Hear from our satisfied clients about their experiences with our services.
                </p>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-10 mx-auto">
                <div class="owl-carousel testimonial-carousel wow fadeInUp" data-wow-delay="0.2s">
                    {% for comment in comments %}
                        <div class="testimonial-card text-center">
                            <img class="testimonial-avatar"
                                 src="{% if comment.user.profile_picture %}{{ comment.user.profile_picture.url }}{% else %}{% static 'img/icon/logo-white.png' %}{% endif %}"
                                 alt="{{ comment.user.first_name }}"
                                 style="width: 80px !important; height: 80px !important; border-radius: 50% !important; object-fit: cover !important; object-position: center !important;">
                            <p class="testimonial-content">"{{ comment.content }}"</p>
                            <h5 class="testimonial-author">{{ comment.user.first_name }} {{ comment.user.last_name }}</h5>
                            <p class="testimonial-date">{{ comment.created_at|date:"F d, Y" }}</p>
                        </div>
                    {% empty %}
                        <div class="testimonial-card text-center">
                            <p class="text-muted">No testimonials yet. Be the first to share your experience!</p>
                        </div>
                    {% endfor %}
                </div>

                <!-- Comment Form -->
                {% if request.user.is_authenticated %}
                    <div class="comment-form wow fadeInUp" data-wow-delay="0.3s">
                        <h4 class="mb-4">Share Your Experience</h4>
                        <form method="POST" action="">
                            {% csrf_token %}
                            <div class="form-group mb-4">
                                <label for="id_content" class="form-label">Your Comment</label>
                                <textarea id="id_content" name="content" class="form-control" rows="4" placeholder="Tell us about your experience with our services..." required></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="fas fa-paper-plane me-2"></i>Submit Comment
                            </button>
                        </form>
                    </div>
                {% else %}
                    <div class="text-center mt-5 wow fadeInUp" data-wow-delay="0.3s">
                        <p class="text-muted">Want to share your experience?
                            <a href="{% url 'login' %}" class="text-primary fw-bold">Login</a> or
                            <a href="{% url 'register' %}" class="text-primary fw-bold">Register</a> to leave a comment.
                        </p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>

<!-- MODERN CHAT WIDGET -->
<!-- Chat Toggle Button -->
<div class="chat-toggle-btn" id="chatToggleBtn">
    <i class="fas fa-comment-dots"></i>
</div>

<!-- Chat Container -->
<div class="modern-chat-container" id="modernChatContainer">
    <!-- Chat Header -->
    <div class="modern-chat-header">
        <div class="chat-avatar">
            <img src="{% static 'img/icon/logo-white.png' %}" alt="Support">
        </div>
        <div class="chat-header-info">
            <h6>Eric's Consulting</h6>
            <p>Last seen recently</p>
        </div>
        <button class="chat-close-btn" id="chatCloseBtn">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <!-- Chat Messages -->
    <div class="modern-chat-messages" id="modernChatMessages">
        <!-- Welcome message (default) -->
        <div class="chat-message bot-message">

            <div class="message-avatar">
                <i class="fas fa-user-tie"></i>
            </div>

            <!-- ðŸ”¥ TOâ€˜Gâ€˜RILANGAN QISM -->
            <div class="message-bubble">
                <div class="message-content">
                    Salom, sizga qanday yordam bera olaman?
                </div>
                <div class="message-time">Just now</div>
            </div>
            <!-- ðŸ”¥ TOâ€˜Gâ€˜RILANGAN QISM TUGADI -->

        </div>
    </div>


    <!-- Chat Input -->
    <div class="modern-chat-input">
        <input type="text"
               class="chat-input-field"
               id="chatInputField"
               placeholder="Ask me anything..."
               autocomplete="off">
        <button class="chat-send-btn" id="chatSendBtn">
            <i class="fas fa-paper-plane"></i>
        </button>
    </div>
</div>

{% endblock %}

{% block js %}
<script>
    $(document).ready(function() {
        // Team Carousel
        $('.team-carousel').owlCarousel({
            loop: true,
            margin: 30,
            nav: false,
            dots: true,
            autoplay: true,
            autoplayTimeout: 5000,
            autoplayHoverPause: true,
            smartSpeed: 1200,
            responsive: {
                0: { items: 1 },
                768: { items: 2 },
                992: { items: 3 }
            }
        });

        // Testimonial Carousel
        $('.testimonial-carousel').owlCarousel({
            loop: true,
            margin: 30,
            nav: false,
            dots: true,
            autoplay: true,
            autoplayTimeout: 5000,
            autoplayHoverPause: true,
            smartSpeed: 800,
            responsive: {
                0: { items: 1 },
                768: { items: 1 },
                992: { items: 1 }
            }
        });

        // Counter Up with Waypoints
        if ($('[data-toggle="counter-up"]').length) {
            $('[data-toggle="counter-up"]').each(function() {
                var $this = $(this);
                var waypoint = new Waypoint({
                    element: this,
                    handler: function() {
                        $this.counterUp({
                            delay: 10,
                            time: 2000
                        });
                        this.destroy();
                    },
                    offset: '80%'
                });
            });
        }

        // ========================================
        // MODERN CHAT WIDGET FUNCTIONALITY
        // ========================================

        const chatToggleBtn = $('#chatToggleBtn');
        const chatContainer = $('#modernChatContainer');
        const chatCloseBtn = $('#chatCloseBtn');
        const chatMessages = $('#modernChatMessages');
        const chatInput = $('#chatInputField');
        const chatSendBtn = $('#chatSendBtn');

        // Toggle chat window
        chatToggleBtn.on('click', function() {
            chatContainer.toggleClass('active');
            if (chatContainer.hasClass('active')) {
                fetchChatHistory();

                // ðŸ”¥ Mobil brauzerlarda ishlashi uchun kechiktirib fokus berish
                setTimeout(() => {
                    chatInput.focus();
                }, 150);
            }
        });

        // Close chat window
        chatCloseBtn.on('click', function() {
            chatContainer.removeClass('active');
        });

        // Function to get current time
        function getCurrentTime() {
            const now = new Date();
            return now.toLocaleTimeString('en-US', {
                hour: '2-digit',
                minute: '2-digit',
                hour12: false
            });
        }

        // Function to scroll to bottom
        function scrollToBottom() {
            chatMessages.scrollTop(chatMessages[0].scrollHeight);
        }

        // Function to add message to chat
        function addMessage(text, isUser = false) {
            const messageClass = isUser ? 'user-message' : 'bot-message';
            const avatarIcon = isUser ? 'fa-user' : 'fa-user-tie';
            const currentTime = getCurrentTime();

            const messageHTML = `
                <div class="chat-message ${messageClass}">
                    <div class="message-avatar">
                        <i class="fas ${avatarIcon}"></i>
                    </div>
                    <div>
                        <div class="message-content">
                            ${escapeHtml(text)}
                        </div>
                        <div class="message-time">${currentTime}</div>
                    </div>
                </div>
            `;

            chatMessages.append(messageHTML);
            scrollToBottom();
        }

        // Function to escape HTML
        function escapeHtml(text) {
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.replace(/[&<>"']/g, function(m) { return map[m]; });
        }

        // Function to fetch chat history
        function fetchChatHistory() {
            $.ajax({
                url: '{% url "chat_with_bot" %}',
                method: 'GET',
                success: function(response) {
                    // Clear existing messages except welcome message
                    chatMessages.find('.chat-message:not(:first)').remove();

                    if (response.chat_history && response.chat_history.length > 0) {
                        response.chat_history.forEach(function(message) {
                            const isUser = message.sender === 'user';
                            addMessage(message.text, isUser);
                        });
                    }
                },
                error: function(error) {
                    console.error('Error fetching chat history:', error);
                }
            });
        }

        // Function to send message
        function sendMessage() {
            const messageText = chatInput.val().trim();

            if (messageText === '') {
                return;
            }

            // Disable send button
            chatSendBtn.prop('disabled', true);

            // Add user message to chat
            addMessage(messageText, true);

            // Clear input
            chatInput.val('');

            // Send message to server
            $.ajax({
                url: '{% url "chat_with_bot" %}',
                method: 'POST',
                data: {
                    'message': messageText,
                    'csrfmiddlewaretoken': '{{ csrf_token }}'
                },
                success: function(response) {
                    if (response.messages && response.messages.length > 0) {
                        response.messages.forEach(function(msg) {
                            addMessage(msg.text, false);
                        });
                    }
                    chatSendBtn.prop('disabled', false);
                    chatInput.focus();
                },
                error: function(error) {
                    if (error.status === 401) {
                        addMessage('Please log in or register to use the chatbot.', false);
                    } else {
                        addMessage('Sorry, there was an error. Please try again.', false);
                        console.error('Error sending message:', error);
                    }
                    chatSendBtn.prop('disabled', false);
                    chatInput.focus();
                }
            });
        }

        // Send message on button click
        chatSendBtn.on('click', function() {
            sendMessage();
        });

        // Send message on Enter key
        chatInput.on('keypress', function(e) {
            if (e.which === 13 && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        // Close chat when clicking outside (optional)
        $(document).on('click', function(e) {
            if (!$(e.target).closest('.modern-chat-container, .chat-toggle-btn').length) {
                if (chatContainer.hasClass('active')) {
                    // Uncomment to enable close on outside click
                    // chatContainer.removeClass('active');
                }
            }
        });
    });
</script>
{% endblock %}