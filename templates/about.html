{% extends 'base.html' %}
{% load static %}

{% block css %}
    <!-- Local Libraries Stylesheet -->
    <link href="{% static 'lib/owlcarousel/assets/owl.carousel.min.css' %}" rel="stylesheet">
    <link href="{% static 'lib/owlcarousel/assets/owl.theme.default.min.css' %}" rel="stylesheet">

    <!-- Local Customized Bootstrap Stylesheet -->
    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    
    <script src="{% static 'lib/counterup/counterup.min.js' %}"></script>


    <!-- Local Template Stylesheet -->
    <link href="{% static 'css/style.css' %}" rel="stylesheet">
    <style>
/* Chat icon */
#chat-icon {
    position: fixed; /* Fixed position */
    bottom: 40px; /* Adjusted to ensure chat icon is visible */
    left: 50px; /* Positioned on the left */
    font-size: 24px; /* Icon size */
    cursor: pointer;
    z-index: 1000; /* Ensure it is above other content */
    background-color: #007bff; /* Icon background color */
    color: #fff; /* Icon color */
    border-radius: 50%; /* Circular icon */
    padding: 10px; /* Padding around icon */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Shadow for depth */
    transition: background-color 0.3s, transform 0.3s; /* Smooth transitions */
}

#chat-icon:hover {
    background-color: #0056b3; /* Darker background on hover */
    transform: scale(1.1); /* Slightly increase size on hover */
}

/* Chat window */
#chat-window {
    {#display: none;#}
    position: fixed;
    bottom: 95px;
    left: 50px; /* Align with the left side of the viewport */
    width: 300px;
    height: 500px;
    background-color: #c2bfbf;
    border-radius: 25px;
    box-shadow: 0 0 12px rgba(0, 0, 0, 0.2);
    display: flex;
    flex-direction: column;
    z-index: 1000;
}

/* Chat header */
#chat-header {
    background-color: rgba(0, 123, 255, 0.9);
    color: white;
    padding: 10px;
    border-radius: 25px 25px 0 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

/* Close button */
#chat-close-button {
    cursor: pointer;
    background-color: #dc1030;
    border-radius: 50px;
    color: white;
    font-size: 24px; /* Adjusted to fit design */
}

/* Chat messages container */
#chat-messages {
    flex: 1;
    overflow-y: auto;
    padding: 10px;
    word-wrap: break-word; /* Break long words to avoid horizontal scroll */
}

/* Message styling */
.message {
    max-width: 80%; /* Limit width to avoid stretching */
    margin-bottom: 10px; /* Space between messages */
    padding: 10px;
    border-radius: 10px;
    line-height: 1.5; /* Space between lines */
}

/* User message */
.user-message {
    align-self: flex-end; /* Align to the right */
    margin-left: 100px;
    font-size: 15px;
    background-color: #007bff; /* Blue background for user messages */
    color: white; /* Text color for user messages */
}

/* Answer message */
.answer-message {
    align-self: flex-start; /* Align to the left */
    font-size: 15px;
    background-color: #ffffff; /* White background for answer messages */
    color: #000000; /* Text color for answer messages */
}

/* Input container */
#chat-input-container {
    display: flex;
    padding: 10px;
    background-color: #fff;
    border-top: 1px solid #ddd;
    border-radius: 0 0 25px 25px;
}

/* Input field */
#chat-input {
    flex: 1;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 10px;
}

/* Send button */
#send-button {
    background-color: #007bff;
    color: white;
    border: none;
    padding: 10px;
    margin-left: 10px;
    border-radius: 15px;
    cursor: pointer;
}


        </style>

{% endblock %}

{%  block content %}


<!-- About Start -->
<div class="container-fluid py-5 mb-5" style="background-color: #fcfbfb;">
    <div class="container">
        <div class="row">
            <div class="col-lg-5">
                <div class="d-flex flex-column align-items-center justify-content-center bg-about rounded h-100 py-5 px-3" style="background-color: #f6f1f1;">
                    <i class="fa fa-5x fa-award text-primary mb-4"></i>
                    <h1 class="display-2 text-white mb-2" data-toggle="counter-up">17</h1>
                    <h2 class="text-white m-0">Years Experience</h2>
                </div>
            </div>
            <div class="col-lg-7 pt-5 pb-lg-5">
                <h6 class="font-weight-semi-bold text-uppercase mb-3" style="font-size: 1.2rem; color: rgba(19,58,96,0.9)">Learn About Us</h6>
                <h1 class="mb-4 section-title" style="font-size: 3rem;">We are a  Consulting service in USA</h1>

                <h5 class="text-muted font-weight-normal mb-3" style="font-size: 1.2rem;">"We specialize in providing expert legal consultation and services tailored to
                    individuals and businesses navigating the complexities of U.S. law.
                    Whether you need assistance with corporate formation, immigration,
                    compliance, or litigation, our team is dedicated to offering precise,
                    reliable, and strategic legal guidance every step of the way.".</h5>

                <p style="font-size: 1.1rem;"> "Meet our highly skilled legal professionals, each with a wealth of experience in various
                    fields of U.S. law. Our team is committed to delivering personalized, strategic legal solutions to help you navigate
                    complex legal challenges and achieve successful outcomes."</p>
                <div class="d-flex align-items-center pt-4">
                <a href="" class="btn btn-primary mr-5">Learn More</a>
                <a href="https://www.youtube.com/watch?v=qF0PdgefNMY" target="_blank" class="btn-play" style="margin-left: 20px; position: relative;">
                    <span></span>
                </a>
                <h5 class="font-weight-normal text-black-50 m-0 ml-4 d-none d-sm-block" style="font-size: 1.2rem; margin-left: 40px;">Watch Video</h5>
            </div>
            </div>
        </div>
    </div>
</div>
<!-- About End -->


<!-- Video Modal Start -->
<div class="modal fade" id="videoModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-body">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <!-- 16:9 aspect ratio -->
                <div class="embed-responsive embed-responsive-16by9">
                    <iframe class="embed-responsive-item" src="" id="video" allowscriptaccess="always" allow="autoplay"></iframe>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Video Modal End -->

   <!-- About Us Section Start -->
<div class="about-us container-fluid py-5">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="about-content">
                    <h2 class="about-title">About Us</h2>
                    <p class="about-text">
                        Eric's Consulting LLC was established on March 3, 2023, in Loveland, Ohio, USA.
                        The purpose of creating this company is to provide civil services to the members of the
                        Uzbek community living in America and to the brotherly peoples from the Central Asian region.
                        This includes forming business entities, streamlining trucking company operations, and providing
                        a wide range of services including placement assistance, license acquisition, loan support, tax advice,
                        housing services, visa consultations, childcare, and school placement services.
                    </p>
                    <p class="about-text">
                        Our main goal is to offer affordable and high-quality services to Uzbek citizens living in the USA!
                        The founder and head of the institution is lawyer Erkinbai Abdullaev, who brings 14 years of experience from
                        various ministries and agencies of the republic, and 2 years of experience working in the branch of a German
                        logistics company in Poland.
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- About Us Section End -->



    <!-- Features Start -->
    <div class="container-fluid bg-light py-5">
        <div class="container py-5">
            <div class="row">
                <div class="col-lg-7 pt-lg-5 pb-3">
                    <h6 class="font-weight-semi-bold text-uppercase mb-3" style="color: rgba(0,123,255,0.9)">Why Choose Us</h6>
                    <h1 class="mb-4 section-title">"14 Years of Expertise in U.S. Legal Consulting"</h1>

                    <p class="mb-4">With over a decade of experience in legal consulting, we specialize in guiding clients
                        through complex legal processes, offering expert advice on everything from business formation to immigration,
                        tax, and compliance issues. Our extensive knowledge ensures that you're in capable hands for every legal challenge.</p>

                            <div class="row">
                        <div class="col-sm-4">
                            <h1 class="text-mine mb-2" data-toggle="counter-up">160</h1>
                            <h6 class="font-weight-semi-bold mb-sm-4">New Applications</h6>
                        </div>
                        <div class="col-sm-4">
                            <h1 class="text-mine mb-2" data-toggle="counter-up">15</h1>
                            <h6 class="font-weight-semi-bold mb-sm-4">In Processing</h6>
                        </div>
                        <div class="col-sm-4">
                            <h1 class="text-mine mb-2" data-toggle="counter-up">145</h1>
                            <h6 class="font-weight-semi-bold mb-sm-4">Finished</h6>
                        </div>
                    </div>
                </div>
                <div class="col-lg-5" style="min-height: 400px;">
                    <div class="position-relative h-100 rounded overflow-hidden">
                        <img class="position-absolute w-100 h-100" src="{% static 'img/feature.jpg' %}" style="object-fit: cover;">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Features End -->

 <!-- Team Start -->
<div class="container-fluid pt-5">
    <div class="container py-5">
        <div class="row align-items-end mb-4">
            <div class="col-lg-6">
                <h6 class="text-mine font-weight-semi-bold text-uppercase mb-3">Meet Our Team</h6>
                <h1 class="section-title mb-3">Meet Our Highly Experienced Team</h1>
            </div>
            <div class="col-lg-6">
                <h4 class="font-weight-normal text-muted mb-3">
                    Our team is not only skilled but also dedicated to providing the best service possible. We value professionalism and expertise in every aspect of our work.
                </h4>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <div class="owl-carousel team-carousel">
                    {% for member in team_members %}
                     <div class="team d-flex flex-column text-center rounded overflow-hidden">
                        <div class="position-relative team-member">
                            <div class="team-img">
                                {% if member.user.profile_picture %}
                                <img class="img" src="{{ member.user.profile_picture.url }}" alt="{{ member.user.first_name }} {{ member.user.last_name }}">
                                {% else %}
                                <img class="img-fluid" src="{% static 'img/default-profile.jpg' %}" alt="Default Profile Picture">
                                {% endif %}
                            </div>
                            <div class="team-overlay">
                                <div class="team-social flex-column justify-content-center">
                                    {% if member.twitter is not None %}
                                    <a class="btn btn-secondary btn-social mb-2" href="{{ member.twitter }}"><i class="fab fa-x"></i></a>
                                    {% else %}
                                      <a class="btn btn-secondary btn-social mb-2" href="https://www.twitter.com/"><i class="fab fa-x"></i></a>
                                    {% endif %}
                                    {% if member.instagram is not None %}
                                    <a class="btn btn-secondary btn-social mb-2" href="{{ member.instagram }}"><i class="fab fa-instagram"></i></a>
                                    {% else %}
                                    <a class="btn btn-secondary btn-social mb-2" href="https://www.instagram.com/"><i class="fab fa-instagram"></i></a>
                                    {% endif %}
                                    {% if member.facebook is not None %}
                                    <a class="btn btn-secondary btn-social mb-2" href="{{ member.facebook }}"><i class="fab fa-facebook-f"></i></a>
                                    {% else %}
                                    <a class="btn btn-secondary btn-social mb-2" href="https://www.facebook.com/"><i class="fab fa-facebook"></i></a>
                                    {% endif %}
                                    {% if member.linkedin is not None %}
                                    <a class="btn btn-secondary btn-social" href="{{ member.linkedin }}"><i class="fab fa-linkedin-in"></i></a>
                                    {% else %}
                                    <a class="btn btn-secondary btn-social mb-2" href="https://www.linkedin.com/"><i class="fab fa-linkedin"></i></a>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <div class="flex-column bg-primary text-center py-1">
                            <h5 class="font-weight-bold" style="color: rgb(255,255,255)">{{ member.user.first_name }} {{ member.user.last_name }}</h5>
                            <p class=" m-0" style="color: #989898">{{ member.role }}</p>
                        </div>
                        <!-- Description Section -->
                        <div class="team-description p-3">
                            {% if member.description %}
                            <p>{{ member.description }}</p>
                            {% else%}
                                <p>"Bringing a fresh perspective and innovative approach, 
                                    <span class="team-member-name">{{ member.user.first_name }} {{ member.user.last_name }}</span> 
                                    is instrumental in developing creative strategies and solutions. 
                                    Their ability to think outside the box leads to effective problem-solving and improved processes."
                                </p>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Team End -->
    

    <!-- Chat Icon -->
<div id="chat-icon">
    <i class="fa fa-comments"></i>
</div>

<!-- Chat Window -->
<div id="chat-window">
    <div id="chat-header">
        <span>Chat</span>
        <button id="chat-close-button">&times;</button>
    </div>
    <div id="chat-messages">
    </div>

    <div id="chat-input-container">
        <textarea id="chat-input" placeholder="Type your message..."></textarea>
        <button id="send-button">Send</button>
    </div>
</div>

{% endblock %}



{% block js %}
    
     <!-- Локальные JavaScript библиотеки -->
    <script src="/static/lib/wow/wow.min.js"></script>
    <script src="/static/lib/easing/easing.min.js"></script>
    <script src="/static/lib/waypoints/waypoints.min.js"></script>
    <script src="/static/lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="/static/lib/counterup/counterup.min.js"></script>

    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>

    <!-- Template JavaScript -->
    <script src="{% static 'js/main.js' %}"></script>

    <script>
        $(document).ready(function() {
            $('.team-carousel').owlCarousel({
                loop: true,
                margin: 30,
                nav: true,
                navText: ['<i class="fa fa-chevron-left"></i>', '<i class="fa fa-chevron-right"></i>'],
                dots: true,
                autoplay: true,
                autoplayTimeout: 3000,
                autoplayHoverPause: true,
                smartSpeed: 1000,
                responsive: {
                    0: {
                        items: 1
                    },
                    576: {
                        items: 1
                    },
                    992: {
                        items: 3
                    }
                }
            });
        });
        
        $(document).ready(function() {
        $('.counter-up').counterUp({
        delay: 10,
        time: 1000
    });
});
    </script>
    
    <script>
        $(document).ready(function() {

            // Function to fetch chat history
            function fetchChatHistory() {
                $.ajax({
                    url: '{% url "chat_with_bot" %}',  // Ensure this URL is correct
                    method: 'GET',
                    success: function(response) {
                        console.log('Chat history response:', response); // Log response for debugging

                        $('#chat-messages').empty(); // Clear existing messages

                        response.chat_history.forEach(function(message) {
                            var messageClass = message.sender === 'user' ? 'user-message' : 'answer-message';
                            $('#chat-messages').append('<div class="message ' + messageClass + '">' + message.text + '</div>');
                        });

                        $('#chat-messages').scrollTop($('#chat-messages')[0].scrollHeight); // Scroll to the bottom
                    },
                });
            }

            // Call fetchChatHistory on page load
            $('#chat-window').hide(); // Ensure the chat window stays hidden on page load

            // Toggle chat window visibility
            $('#chat-icon').on('click', function() {
                $('#chat-window').toggle(); // Show/Hide chat window
                if ($('#chat-window').is(':visible')) {
                    fetchChatHistory(); // Fetch chat history when opening the chat window
                }
            });

            $('#chat-close-button').on('click', function() {
                $('#chat-window').hide(); // Hide chat window
            });

            $('#send-button').on('click', function() {
                var userMessage = $('#chat-input').val();
                if (userMessage.trim()) {
                    $('#chat-messages').append('<div class="message user-message">' + userMessage + '</div>');
                    

                    $.ajax({
                        url: '{% url "chat_with_bot" %}',  // URL to your Django class-based view
                        method: 'POST',
                        data: {
                            'message': userMessage,
                            'csrfmiddlewaretoken': '{{ csrf_token }}'
                        },
                        success: function(response) {
                            response.messages.forEach(function(msg) {
                                $('#chat-messages').append('<div class="message answer-message">' + msg.text + '</div>');
                            });
                            $('#chat-input').val('');  // Clear input field
                            $('#chat-messages').scrollTop($('#chat-messages')[0].scrollHeight); // Scroll to the bottom
                        },
                    });
                }
            });

            $('#chat-input').on('keypress', function(e) {
                if (e.which === 13 && !e.shiftKey) {
                    e.preventDefault();
                    $('#send-button').click(); // Trigger send button click on Enter key press
                }
            });
        });
    </script>

{% endblock %}